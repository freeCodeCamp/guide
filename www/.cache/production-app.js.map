{"version":3,"sources":["../../src/cache-dir/production-app.js"],"names":["window","matchPath","findPage","foundPage","some","page","pathname","path","exact","preferDefault","m","default","scriptsCache","loadScriptsForPath","cb","scripts","layout","component","pageData","loaded","layouts","index","components","componentChunkName","json","jsonName","navigateTo","___history","push","___loadScriptsForPath","___navigateTo","history","attachToHistory","listen","location","action","shouldUpdateScroll","prevRouterProps","results","length","oldPathname","notFoundScripts","renderPage","props","pageCache","AltRouter","DefaultRouter","children","Root","render","routeProps","layoutProps","NewRoot","document","getElementById"],"mappings":"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","file":"production-app.js","sourcesContent":["import apiRunner from \"./api-runner-browser\"\n// Let the site/plugins run code very early.\napiRunner(`onClientEntry`)\n\nimport React, { createElement } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport {\n  BrowserRouter as Router,\n  Route,\n  withRouter,\n  matchPath,\n} from \"react-router-dom\"\nimport { ScrollContext } from \"react-router-scroll\"\nimport createHistory from \"history/createBrowserHistory\"\nimport pages from \"./pages.json\"\nimport invariant from \"invariant\"\n\nwindow.matchPath = matchPath\n\nimport requires from \"./async-requires\"\n\n// Find page\nconst findPage = pathname => {\n  let foundPage\n  // Array.prototype.find is not supported in IE so we use this somewhat odd\n  // work around.\n  pages.some(page => {\n    if (page.matchPath) {\n      // Try both the path and matchPath\n      if (\n        matchPath(pathname, { path: page.path }) ||\n        matchPath(pathname, {\n          path: page.matchPath,\n        })\n      ) {\n        foundPage = page\n        return true\n      }\n    } else {\n      if (\n        matchPath(pathname, {\n          path: page.path,\n          exact: true,\n        })\n      ) {\n        foundPage = page\n        return true\n      }\n    }\n\n    return false\n  })\n\n  return foundPage\n}\n\n// Load scripts\nconst preferDefault = m => (m && m.default) || m\nconst scriptsCache = {}\nconst loadScriptsForPath = (path, cb = () => {}) => {\n  const page = findPage(path)\n\n  let scripts = {\n    layout: false,\n    component: false,\n    pageData: false,\n  }\n\n  if (!page) {\n    return cb(scripts)\n  }\n\n  if (scriptsCache[page.path]) {\n    return cb(scriptsCache[page.path])\n  }\n\n  const loaded = () => {\n    if (\n      scripts.layout !== false &&\n      scripts.component !== false &&\n      scripts.pageData !== false\n    ) {\n      scriptsCache[page.path] = scripts\n      cb(scripts)\n    }\n  }\n\n  // Load layout file.\n  if (requires.layouts.index) {\n    requires.layouts.index(layout => {\n      scripts.layout = preferDefault(layout)\n      loaded()\n    })\n  } else {\n    scripts.layout = ``\n    loaded()\n  }\n\n  requires.components[page.componentChunkName](component => {\n    scripts.component = preferDefault(component)\n    loaded()\n  })\n\n  requires.json[page.jsonName](pageData => {\n    scripts.pageData = pageData\n    loaded()\n  })\n}\n\nconst navigateTo = pathname => {\n  loadScriptsForPath(pathname, () => {\n    window.___history.push(pathname)\n  })\n}\n\nwindow.___loadScriptsForPath = loadScriptsForPath\nwindow.___navigateTo = navigateTo\n\nconst history = createHistory()\n\nfunction attachToHistory(history) {\n  window.___history = history\n\n  history.listen((location, action) => {\n    apiRunner(`onRouteUpdate`, { location, action })\n  })\n}\n\nfunction shouldUpdateScroll(prevRouterProps, { location: { pathname } }) {\n  const results = apiRunner(`shouldUpdateScroll`, {\n    prevRouterProps,\n    pathname,\n  })\n  if (results.length > 0) {\n    return results[0]\n  }\n\n  if (prevRouterProps) {\n    const { location: { pathname: oldPathname } } = prevRouterProps\n    if (oldPathname === pathname) {\n      return false\n    }\n  }\n  return true\n}\n\n// Load 404 page component and scripts\nlet notFoundScripts\nloadScriptsForPath(`/404.html`, scripts => {\n  notFoundScripts = scripts\n})\n\nconst renderPage = props => {\n  const page = findPage(props.location.pathname)\n  if (page) {\n    const pageCache = scriptsCache[page.path]\n\n    invariant(\n      pageCache,\n      `Page cache miss at ${props.location\n        .pathname} for key ${page.path}. Available keys: ${Object.keys(\n        scriptsCache\n      )}`\n    )\n\n    return createElement(pageCache.component, {\n      ...props,\n      ...pageCache.pageData,\n    })\n  } else if (notFoundScripts) {\n    return createElement(notFoundScripts.component, {\n      ...props,\n      ...notFoundScripts.pageData,\n    })\n  } else {\n    return null\n  }\n}\n\nconst AltRouter = apiRunner(`replaceRouterComponent`, { history })[0]\nconst DefaultRouter = ({ children }) => (\n  <Router history={history}>{children}</Router>\n)\n\nloadScriptsForPath(window.location.pathname, scripts => {\n  // Use default layout if one isn't set.\n  let layout\n  if (scripts.layout) {\n    layout = scripts.layout\n  } else {\n    layout = props => <div>{props.children()}</div>\n  }\n\n  const Root = () =>\n    createElement(\n      AltRouter ? AltRouter : DefaultRouter,\n      null,\n      createElement(\n        ScrollContext,\n        { shouldUpdateScroll },\n        createElement(withRouter(layout), {\n          children: layoutProps =>\n            createElement(Route, {\n              render: routeProps => {\n                attachToHistory(routeProps.history)\n                const props = layoutProps ? layoutProps : routeProps\n                return renderPage(props)\n              },\n            }),\n        })\n      )\n    )\n\n  const NewRoot = apiRunner(`wrapRootComponent`, { Root }, Root)[0]\n  ReactDOM.render(\n    <NewRoot />,\n    typeof window !== `undefined`\n      ? document.getElementById(`___gatsby`)\n      : void 0\n  )\n})\n"]}