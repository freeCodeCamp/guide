{"version":3,"sources":["../../src/cache-dir/root.js"],"names":["history","listen","location","action","shouldUpdateScroll","prevRouterProps","pathname","results","length","oldPathname","$","createElement","noMatch","find","r","path","addNotFoundRoute","key","component","components","componentChunkName","props","json","jsonName","navigateTo","window","___history","push","___navigateTo","AltRouter","DefaultRouter","children","layout","layouts","Root","render","routeProps","layoutProps","page","matchPath","exact","WrappedRoot"],"mappings":"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","file":"root.js","sourcesContent":["import React from \"react\"\nimport {\n  BrowserRouter as Router,\n  Route,\n  matchPath,\n  withRouter,\n} from \"react-router-dom\"\nimport { ScrollContext } from \"react-router-scroll\"\nimport createHistory from \"history/createBrowserHistory\"\n\nimport apiRunner from \"./api-runner-browser\"\nimport syncRequires from \"./sync-requires\"\nimport pages from \"./pages.json\"\n\nconst history = createHistory()\nhistory.listen((location, action) => {\n  apiRunner(`onRouteUpdate`, location, action)\n})\n\nfunction shouldUpdateScroll(prevRouterProps, { location: { pathname } }) {\n  const results = apiRunner(`shouldUpdateScroll`, {\n    prevRouterProps,\n    pathname,\n  })\n  if (results.length > 0) {\n    return results[0]\n  }\n\n  if (prevRouterProps) {\n    const { location: { pathname: oldPathname } } = prevRouterProps\n    if (oldPathname === pathname) {\n      return false\n    }\n  }\n  return true\n}\n\nconst $ = React.createElement\n\nconst noMatch = pages.find(r => r.path === `/dev-404-page/`)\n\nconst addNotFoundRoute = () => {\n  if (noMatch) {\n    return $(Route, {\n      key: `404-page`,\n      component: props =>\n        $(syncRequires.components[noMatch.componentChunkName], {\n          ...props,\n          ...syncRequires.json[noMatch.jsonName],\n        }),\n    })\n  } else {\n    return null\n  }\n}\n\nconst navigateTo = pathname => {\n  window.___history.push(pathname)\n}\n\nwindow.___navigateTo = navigateTo\n\nconst AltRouter = apiRunner(`replaceRouterComponent`, { history })[0]\nconst DefaultRouter = ({ children }) =>\n  <Router history={history}>{children}</Router>\n\n// Use default layout if one isn't set.\nlet layout\nif (syncRequires.layouts[`index`]) {\n  layout = syncRequires.layouts[`index`]\n} else {\n  layout = ({ children }) => <div>{children()}</div>\n}\n\nconst Root = () =>\n  $(\n    AltRouter ? AltRouter : DefaultRouter,\n    null,\n    $(\n      ScrollContext,\n      { shouldUpdateScroll },\n      $(withRouter(layout), {\n        children: layoutProps =>\n          $(Route, {\n            render: routeProps => {\n              window.___history = routeProps.history\n              const props = layoutProps ? layoutProps : routeProps\n              const page = pages.find(page => {\n                if (page.matchPath) {\n                  // Try both the path and matchPath\n                  return (\n                    matchPath(props.location.pathname, { path: page.path }) ||\n                    matchPath(props.location.pathname, {\n                      path: page.matchPath,\n                    })\n                  )\n                } else {\n                  return matchPath(props.location.pathname, {\n                    path: page.path,\n                    exact: true,\n                  })\n                }\n              })\n              if (page) {\n                return $(syncRequires.components[page.componentChunkName], {\n                  ...props,\n                  ...syncRequires.json[page.jsonName],\n                })\n              } else {\n                return addNotFoundRoute()\n              }\n            },\n          }),\n      })\n    )\n  )\n\n// Let site, plugins wrap the site e.g. for Redux.\nconst WrappedRoot = apiRunner(`wrapRootComponent`, { Root }, Root)[0]\n\nexport default WrappedRoot\n"]}